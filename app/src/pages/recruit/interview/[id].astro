---
import RecruitLayout from '../../../layouts/RecruitLayout.astro';
import RecruitFooter from '../../../components/RecruitFooter.astro';
import RecruitCta from '../../../components/RecruitCta.astro';
import { generateRecruitJsonLd } from '../../../lib/seo/jsonld';


export async function getStaticPaths() {
  // インタビューデータを読み込む
  let interviewData: any[] = [];
  try {
    const fs = await import('fs');
    const path = await import('path');
    const interviewDataPath = path.join(process.cwd(), 'public', 'data', 'interviews.index.json');
    const interviewDataContent = fs.readFileSync(interviewDataPath, 'utf-8');
    interviewData = JSON.parse(interviewDataContent);
  } catch (error) {
    console.error('インタビューデータの読み込みに失敗しました:', error);
    interviewData = [];
  }

  return interviewData.map((interview) => ({
    params: { id: interview.id.toString() },
    props: { interview },
  }));
}

const { interview } = Astro.props;

if (!interview) {
  throw new Error('Interview not found');
}

const title = interview.title || "社員インタビュー - little";
const description = "littleで働くスタッフのインタビュー記事をご紹介します。";
const image = interview.heroImageUrl || "https://images.unsplash.com/photo-1580618672591-eb180b1a973f?w=1200&h=630&fit=crop";

// 採用ページのJSON-LDを生成
const jsonLd = generateRecruitJsonLd();
---

<RecruitLayout title={title} description={description} image={image} jsonLd={JSON.stringify(jsonLd)}>
  <!-- ページ全体の背景をbeigeに設定 -->
  <div class="bg-beige">
      
      <!-- パンくずリスト -->
      <div class="breadcrumb">
        <div class="breadcrumb__container">
          <nav class="breadcrumb__nav">
            <a href="/" class="breadcrumb__link">ホーム</a>
            <span class="breadcrumb__separator">/</span>
            <a href="/recruit" class="breadcrumb__link">採用ページ</a>
            <span class="breadcrumb__separator">/</span>
            <span class="breadcrumb__current">{interview.title}</span>
          </nav>
        </div>
      </div>

      <!-- ヒーローセクション -->
      <section class="interview-hero">
        <div class="interview-hero__container">
          <h1 class="interview-hero__title">{interview.title}</h1>
          {interview.heroImageUrl && (
            <div class="interview-hero__image">
              <img 
                src={interview.heroImageUrl} 
                alt={interview.title}
                class="interview-hero__image-content"
              />
            </div>
          )}
        </div>
      </section>

      <!-- メインコンテンツ -->
      <section class="interview-content">
        <div class="interview-content__container">
          <div class="interview-content__body" set:html={interview.content}></div>
        </div>
      </section>

    <!-- 応募CTA -->
    <RecruitCta />

    <!-- フッター -->
    <RecruitFooter />
  </div>
</RecruitLayout>

<style>
  @import "tailwindcss";
  
  /* CSS変数の定義 */
  :root {
    --color-beige: #FAF4E8;
    --color-brown: #69552E;
    --color-brown-light: #8B6F47;
    --color-white: #FFFFFF;
    --color-black: #3D3D3D;
    --color-grey-light: #E5E5E5;
    --color-grey-medium: #666666;
    --font-family-yumincho: 'Yu Mincho', 'YuMincho', 'Hiragino Mincho Pro', 'MS PMincho', serif;
    --font-family-zenkaku: 'Zen Kaku Gothic New', 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Meiryo', sans-serif;
    --font-weight-regular: 400;
    --font-weight-medium: 500;
    --font-weight-semibold: 600;
    --font-weight-bold: 700;
  }
  
  /* ページ全体の背景 */
  .bg-beige {
    background-color: var(--color-beige);
    min-height: 100vh;
  }

  /* パンくずリスト */
  .breadcrumb {
    padding: 104px 0 16px 0;
    background-color: var(--color-beige);
  }

  .breadcrumb__container {
    max-width: 1040px;
    margin: 0 auto;
  }

  .breadcrumb__nav {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    color: var(--color-grey-medium);
    flex-wrap: nowrap;
    overflow: hidden;
  }

  .breadcrumb__link {
    color: var(--color-grey-medium);
    text-decoration: none;
    transition: color 0.3s ease;
    white-space: nowrap;
  }

  .breadcrumb__link:hover {
    color: var(--color-brown);
  }

  .breadcrumb__separator {
    color: var(--color-grey-medium);
    flex-shrink: 0;
  }

  .breadcrumb__current {
    color: var(--color-grey-medium);
    font-weight: var(--font-weight-regular);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 200px;
  }

  /* ヒーローセクション */
  .interview-hero {
    padding: 40px 0 60px;
    background-color: var(--color-beige);
  }

  .interview-hero__container {
    max-width: 1040px;
    margin: 0 auto;
    text-align: left;
  }

  .interview-hero__title {
    font-size: 40px;
    font-family: var(--font-family-yumincho);
    font-weight: var(--font-weight-medium);
    color: var(--color-black);
    line-height: 1.3;
    text-align: center;
    margin-bottom: 40px;
    position: relative;
    z-index: 2;
  }

  .interview-hero__title::before {
    content: '';
    position: absolute;
    top: -50px;
    left: 50%;
    transform: translateX(-50%);
    width: 342px;
    height: 110px;
    background-image: url('/images/recruit/txt_staff-voices.svg');
    background-repeat: no-repeat;
    background-size: contain;
    background-position: center;
    z-index: -1;
    opacity: 1;
  }

  .interview-hero__image {
    width: 100%;
    margin: 0 auto;
    position: relative;
    z-index: 2;
  }

  .interview-hero__image-content {
    width: 100%;
    height: auto;
    border-radius: 12px;
    object-fit: cover;
  }

  /* メインコンテンツ */
  .interview-content {
    padding: 0 0 80px;
    background-color: var(--color-beige);
  }

  .interview-content__container {
    max-width: 1040px;
    margin: 0 auto;
  }

  .interview-content__body {
    font-family: var(--font-family-zenkaku);
    line-height: 1.5;
    color: var(--color-black);
    text-align: center;
  }

  :global(.interview-content__body h2) {
    font-size: 24px;
    font-family: var(--font-family-zenkaku);
    font-weight: var(--font-weight-medium);
    color: var(--color-black);
    margin: 40px 0 24px 0;
    position: relative;
    padding-left: 20px;
    text-align: left;
  }

  :global(.interview-content__body h2::before) {
    content: '';
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    width: 4px;
    min-height: 32px;
    height: 100%;
    border-radius: 50px;
    background-color: var(--color-black);
  }

  :global(.interview-content__body h2:first-child) {
    margin-top: 0;
  }

  :global(.interview-content__body h3) {
    font-size: 20px;
    font-family: var(--font-family-zenkaku);
    font-weight: var(--font-weight-medium);
    color: var(--color-black);
    margin: 40px 0 24px 0;
    position: relative;
    padding-left: 6px;
    text-align: left;
  }
  :global(.interview-content__body h3::before) {
    content: '';
    position: absolute;
    left: 0;
    bottom: -8px;
    width: 100%;
    height: 3px;
    border-radius: 50px;
    background-color: var(--color-black);
  }
  :global(.interview-content__body p) {
    width: 100%;
    font-size: 16px !important;
    line-height: 1.5 !important;
    margin-bottom: 24px !important;
    color: var(--color-black) !important;
    font-family: var(--font-family-zenkaku) !important;
    font-weight: var(--font-weight-regular) !important;
    text-align: left;
  }

  :global(.interview-content__body img) {
    width: 100% !important;
    max-width: 710px !important;
    height: auto !important;
    border-radius: 8px !important;
    margin: 32px 0 !important;
    object-fit: cover !important;
  }

  :global(.interview-content__body div) {
    margin-bottom: 24px !important;
  }

  :global(.interview-content__body img:first-child) {
    display: none;
  }

  /* より具体的なセレクターで確実に適用 */
  :global(.interview-content__body > div > p) {
    font-size: 16px !important;
    line-height: 1.5 !important;
    margin-bottom: 40px !important;
    color: var(--color-black) !important;
    font-family: var(--font-family-zenkaku) !important;
    font-weight: var(--font-weight-regular) !important;
  }


  /* レスポンシブ対応 */
  @media (max-width: 768px) {
    .breadcrumb__nav {
      gap: 4px;
      font-size: 12px;
      padding: 0 24px;
    }

    .breadcrumb__current {
      max-width: 120px;
    }

    .interview-hero {
      padding: 16px 24px;
    }

    .interview-hero__title {
      font-size: 32px;
      margin-bottom: 24px;
      line-height: 1.25;
      text-align: left;
    }

    .interview-hero__title::before {
      width: 185px;
      height: 60px;
      top: -40px;
      left: 80px;
    }

    :global(.interview-content__body) {
      padding: 0 24px;
    }
    :global(.interview-content__body h2) {
      font-size: 24px;
      margin: 40px 0 16px 0;
    }

    :global(.interview-content__body p) {
      font-size: 14px !important;
      line-height: 1.6 !important;
      margin-bottom: 24px !important;
    }

    :global(.interview-content__body > div > p) {
      font-size: 14px !important;
      line-height: 1.6 !important;
      margin-bottom: 24px !important;
    }

    :global(.interview-content__body img) {
      width: 100% !important;
      margin: 16px 0 !important;
    }

    :global(.interview-content__body img.alignnone) {
      width: 100% !important;
      margin: 16px 0 !important;
    }

    .recruit-cta-top__content {
      grid-template-columns: 1fr;
      gap: 40px;
    }

    .recruit-cta-top__content::before,
    .recruit-cta-top__content::after {
      display: none;
    }

    .recruit-cta-top__column {
      padding: 0 24px 24px 24px;
      border-bottom: 1px solid #B2B2B2;
    }

    .recruit-cta-top__column:last-child {
      border-bottom: none;
      padding-right: 0;
      padding-left: 0;
      padding-bottom: 0;
    }

    .recruit-cta-top__title {
      font-size: 20px;
      margin-bottom: 30px;
    }

    .recruit-cta-top__column-title {
      font-size: 24px;
      margin-bottom: 12px;
    }

    .recruit-cta-top__column-description {
      font-size: 16px;
      margin-bottom: 12px;
    }

    .recruit-cta-top__btn {
      padding: 14px 16px;
      font-size: 16px;
      width: 100%;
    }

    .recruit-cta-top__phone-number {
      font-size: 42px;
      margin-bottom: 0px;
    }

    .recruit-cta-top__phone-text {
      font-size: 16px;
    }
  }
</style>
